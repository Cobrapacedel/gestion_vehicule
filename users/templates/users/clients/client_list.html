{% extends "core/base.html" %}
{% load static %}

{% block title %}Lis Kliyan{% endblock %}

{% block content %}
<div class="min-h-screen px-6 py-10 bg-gray-900 text-white">

    <h1 class="text-3xl font-bold mb-8 text-center text-yellow-400">
        Lis Kliyan
    </h1>

    <!-- ðŸ” Recherche -->
    <form method="get" class="flex justify-center mb-6">
        <input 
            type="text" 
            name="q"
            placeholder="ChÃ¨che pa non, biznis, telefÃ²n, imÃ¨l..."
            value="{{ request.GET.q }}"
            class="w-1/2 p-2 rounded-l-lg bg-gray-800 border border-gray-700 text-white focus:outline-none"
        >
        <button class="bg-blue-600 px-4 rounded-r-lg hover:bg-blue-700">
            ChÃ¨che
        </button>
    </form>

    <!-- âž• Ajouter -->
    <div class="flex justify-end mb-4">
        <a href="{% url 'users:client_create' %}"
           class="bg-green-600 px-5 py-2 rounded-lg hover:bg-green-700 font-semibold">
            + Ajoute Kliyan
        </a>
    </div>

    <!-- ðŸ“„ Table -->
    <div class="overflow-x-auto bg-gray-800 rounded-lg shadow">
        <table class="min-w-full text-sm">
            <thead class="bg-gray-700 text-gray-200">
                <tr>
                    <th class="p-3 text-left">Kliyan</th>
                    <th class="p-3 text-left">Aksyon</th>
                </tr>
            </thead>

            <tbody>
            {% for client in page_obj %}
                <tr class="border-b border-gray-700 hover:bg-gray-700 transition">

                    <td class="p-3">
                        <span class="px-2 py-1 rounded font-semibold
                            {% if client.client_type == 'user' %} bg-blue-600
                            {% elif client.client_type == 'dealer' %} bg-purple-600
                            {% elif client.client_type == 'agency' %} bg-green-600
                            {% elif client.client_type == 'garage' %} bg-orange-600
                            {% else %} bg-gray-600 {% endif %}
                        ">
                            {% if client.client_type == "user" %}
                                {{ client.real_user.simple.first_name }} {{ client.real_user.simple.last_name }}
                            {% else %}
                                {{ client.real_user.businessprofile.business_name|default:"â€”" }}
                            {% endif %}
                        </span>
                    </td>

                    <td class="p-3">
                        <a href="{% url 'users:client_detail' client.id %}"
                           class="bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600">
                            Detay
                        </a>
                    </td>

                </tr>
            {% empty %}
                <tr>
                    <td colspan="2" class="text-center py-6 text-gray-400">
                        Pa gen okenn kliyan pou moman an.
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- ðŸ“Œ Pagination -->
    {% if page_obj.has_other_pages %}
    <div class="flex justify-center mt-8 space-x-2">

        {% if page_obj.has_previous %}
            <a href="?page={{ page_obj.previous_page_number }}&q={{ request.GET.q }}"
               class="px-4 py-2 bg-gray-700 rounded hover:bg-gray-600">
                Prev
            </a>
        {% endif %}

        <span class="px-4 py-2 bg-gray-800 rounded">
            {{ page_obj.number }} / {{ page_obj.paginator.num_pages }}
        </span>

        {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}&q={{ request.GET.q }}"
               class="px-4 py-2 bg-gray-700 rounded hover:bg-gray-600">
                Next
            </a>
        {% endif %}

    </div>
    {% endif %}

</div>
{% endblock %}